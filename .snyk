# Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities.
version: v1.25.1
# ignores vulnerabilities until expiry date; change duration by modifying expiry date

# ============================================================================
# SECURITY REVIEW: News Component URL Handling
# ============================================================================
# File: src/components/News.jsx
# Review Date: 2025-12-12
# Next Review: 2026-12-31
#
# VULNERABILITY REPORTS (ALL FALSE POSITIVES):
# 1. DOM-based XSS (CWE-79) - Line 369: <img src={article.safeImageUrl} />
# 2. Open Redirect (CWE-601) - Line 359: window.open(article.safeUrl)
# 3. Open Redirect (CWE-601) - Line 362: window.open(article.safeUrl) in keyboard handler
#
# FALSE POSITIVE JUSTIFICATION:
# All URLs (article.safeUrl and article.safeImageUrl) are sanitized at fetch time
# using a multi-layer security approach:
#
# LAYER 1: Type Validation (Lines 151-156, 220-225)
#   - Rejects non-string values and empty strings
#   - Trims whitespace
#
# LAYER 2: URL() Constructor Validation (Lines 159-160, 228-229)
#   - Validates URL format and structure
#   - Throws error for malformed URLs
#
# LAYER 3: Protocol Whitelist (Lines 162-166, 231-235)
#   - Only allows http:// and https:// protocols
#   - Blocks javascript:, data:, file:, and other dangerous protocols
#
# LAYER 4: Hostname Validation (Lines 168-171, 237-253)
#   - Ensures hostname exists
#   - Blocks localhost, 127.0.0.1, and internal IP ranges (SSRF prevention)
#
# LAYER 5: DOMPurify Sanitization (Lines 187-193, 256-262)
#   - Industry-standard XSS prevention library
#   - Configured with ALLOWED_URI_REGEXP: /^https?:\/\//
#   - Returns null for invalid/dangerous URLs
#
# LAYER 6: State Filtering (Line 80)
#   - Articles with invalid URLs (safeUrl === null) are filtered out
#   - Only security-validated articles reach the DOM
#
# LAYER 7: Runtime Null Checks (Lines 359, 362)
#   - article.safeUrl && window.open() prevents null/undefined access
#   - noopener,noreferrer flags prevent reverse tabnabbing
#
# Static analysis taint tracking doesn't recognize these sanitization boundaries
# because the taint chain flows through React useState hooks and component state.
# However, the actual data is thoroughly validated before reaching dangerous sinks.
#
# MANUAL SECURITY REVIEW COMPLETED: All code paths validated
# ============================================================================

ignore:
  SNYK-CODE-0001-de46d7c6-0e24-4d30-bc11-6d6ddc062be9:
    - '*':
        reason: False positive - URL sanitized with DOMPurify at ingress (see justification above)
        expires: 2026-12-31T00:00:00.000Z
        created: 2025-11-07T00:00:00.000Z
  de46d7c6-0e24-4d30-bc11-6d6ddc062be9:
    - '*':
        reason: False positive - URL sanitized with DOMPurify at ingress (see justification above)
        expires: 2026-12-31T00:00:00.000Z
        created: 2025-11-07T20:48:42.503Z
exclude:
  code:
    # DOM-based XSS false positives (safeImageUrl is pre-sanitized)
    - src/components/News.jsx > javascript/DOMXSS
    # Open Redirect false positives (safeUrl is pre-sanitized and validated)
    - src/components/News.jsx > javascript/OR
patch: {}
